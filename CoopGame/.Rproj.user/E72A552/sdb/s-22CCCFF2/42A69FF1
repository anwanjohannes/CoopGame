{
    "collab_server" : "",
    "contents" : "#' @name webersetVertices\n#' @title webersetVertices\n#' @description Calculates the Weber Set for given game vector A.\n#' @aliases webersetVertices\n#' @importFrom grDevices chull\n#' @export webersetVertices\n#' @template author/AM\n#' @template author/FM\n#' @template cites/WEBER_1988\n#' @templateVar WEBER_1988_P pp. 101--119\n#' @template cites/PETERS_2015\n#' @templateVar PETERS_2015_P p. 327 ff.\n#' @inheritParams CoopGameBaseParams\n#' @return rows of the matrix are the vertices of the Weber Set\n#' @examples\n#' #Example 1: A 3-player TU game (with a Weber Set with 6 vertices)\n#' library(CoopGame)\n#' A = c(0,1,2,3,4,5,6)\n#' webersetVertices(A)\n#'\n#' #Example 2: A 4 player TU game (with a Weber Set with 14 vertices)\n#' library(CoopGame)\n#' A = c(5,2,4,7,15,15,15,15,15,15,20,20,20,20,35)\n#' webersetVertices(A)\n#' \nwebersetVertices<-function(A){\n  wv=WebersetConcept(A)\n  payoffSpace=calculateSetSolution(wv)\n  return(payoffSpace@VRepMatrix)\n}\n\nlogicWebersetVertices <- function(A) {\n  numberOfPlayers = getNumberOfPlayers(A)\n  \n  #getMarginalContributions gives the marginal vectors\n  ResultList = getMarginalContributions(A)\n  ResultMatrix = ResultList[[3]]\n  \n  if(numberOfPlayers == 3)\n  {\n    sequencevector = grDevices::chull(ResultMatrix)\n    OutcomeMatrix = ResultMatrix[sequencevector,,drop = FALSE]\n  }\n  else\n  {\n    #Delete redundant points\n    vRep = makeV(points = ResultMatrix)\n    if (nrow(vRep) >= 2)\n    {\n      vRep = redundant(vRep, representation = \"V\")\n    }\n    \n    VectorCounter = length(vRep[[1]]) / (numberOfPlayers + 2)\n    OutcomeVector = vRep[[1]][(VectorCounter * 2 + 1):(length(vRep[[1]]))]\n    ResultMatrix = matrix(OutcomeVector, VectorCounter, numberOfPlayers) \n    OutcomeMatrix = ResultMatrix\n  }\n  return (OutcomeMatrix)\n  \n}\n\n#' @title WebersetConcept - S4 class \n#' @noRd\n#' @include SetSolutionConcept.R\n#' #@exportClass WebersetConcept\n\nsetClass(\n  \"WebersetConcept\",\n  contains = \"SetSolutionConcept\"\n)\n\n#' @title Constructor for WebersetConcept\n#' @noRd\n#' @template author/JA\n#' @name WebersetConcept\n#' @include PayoffSpace.R\n#' #@export\nWebersetConcept<-function(A){\n  retWebersetConcept=methods::new(\"WebersetConcept\",A)\n  return(retWebersetConcept)\n}\n\n#' @rdname getSetSolutionVertices-methods\n#' @aliases getSetSolutionVertices,WebersetConcept-method\nsetMethod(\n  \"getSetSolutionVertices\",\n  signature=\"WebersetConcept\",\n  definition=function(.Object){\n    A<-.Object@A\n    VRep=(logicWebersetVertices(A))\n    return(VRep)\n  }\n)\n\n\n#' @name belongsToWeberset\n#' @title belongsToWeberset for every number of players\n#' @description Checks, if the point is in the Weber Set\n#' @aliases belongsToWeberset\n#' @export belongsToWeberset\n#' @template author/JA\n#' @template cites/WEBER_1988\n#' @templateVar WEBER_1988_P pp. 101--119\n#' @template cites/PETERS_2015\n#' @templateVar PETERS_2015_P p. 327 ff.\n#' @template param/x\n#' @inheritParams CoopGameBaseParams\n#' @return \\code{TRUE} if point belongs to Weber Set and \\code{FALSE} otherwise\n#' @examples\n#' library(CoopGame)\n#' A=c(0,1,2,3,4,5,6)\n#' \n#' #Point belongs to Weber Set:\n#' belongsToWeberset(x=c(1.5,1,3.5),A)\n#' \n#' #Point does not belong to Weber Set:\n#' belongsToWeberset(x=c(2.05,2,2),A)\n\nbelongsToWeberset<-function(x,A){\n  wv=webersetVertices(A) \n  ps=PayoffSpace(VRepMatrix=wv)\n  return(isElementOfPayoffSpace(ps,x=x))\n}\n\n\n#' @name drawWeberset\n#' @title drawWeberset for 3 or 4 players\n#' @description drawWeberset draws the Weber Set for 3 or 4 players.\n#' @aliases drawWeberset\n#' @export drawWeberset\n#' @template author/JA\n#' @template cites/WEBER_1988\n#' @templateVar WEBER_1988_P pp. 101--119\n#' @template cites/PETERS_2015\n#' @templateVar PETERS_2015_P p. 327 ff.\n#' @inheritParams CoopGameBaseParams\n#' @inheritParams visualize\n#' @examples\n#' library(CoopGame)\n#' A = c(0,1,2,3,4,5,6)\n#' drawWeberset(A)\ndrawWeberset<-function(A,holdOn=FALSE, colour = NA , label=FALSE, name = \"Weber Set\"){\n  A=GameVector(A)\n  wv=webersetVertices(A);\n  visualize(A, pointsToDraw=wv, holdOn=holdOn, colour = colour , label=label, name = name)\n}",
    "created" : 1534329147461.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "275047755",
    "id" : "42A69FF1",
    "lastKnownWriteTime" : 1537215659,
    "last_content_update" : 1537215659,
    "path" : "C:/Users/Johannes/Dropbox/UNIVERSITAET/Master_Inf/MASTER_ARBEIT/SVN_REPO/CoopGame/R/WebersetConcept.R",
    "project_path" : "R/WebersetConcept.R",
    "properties" : {
    },
    "relative_order" : 83,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}