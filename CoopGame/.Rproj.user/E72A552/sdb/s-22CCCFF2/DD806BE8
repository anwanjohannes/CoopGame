{
    "collab_server" : "",
    "contents" : "#' @name isWeaklySuperadditiveGame\n#' @title isWeaklySuperadditiveGame\n#' @description Checks if a TU game for n players is weakly superadditive. \\cr\n#' Let \\code{S} be a coalition and \\code{i} a player not contained in \\code{S}. \n#' Then the TU game is weakly superadditive if for any \\code{S} and \n#' any \\code{i} the value of the union of \\code{S} and \\code{i} is\n#' greater or equal the sum of the values of \\code{S} and \\code{i}. \\cr\n#' Note that weak superadditivity is equivalent to zero-monotonicity.\n#' @aliases isZeroMonotonicGame\n#' @export isWeaklySuperadditiveGame\n#' @template author/JA\n#' @template author/JS\n#' @template cites/PELEG_ET_SUDHOELTER_2007\n#' @templateVar PELEG_ET_SUDHOELTER_2007_P p. 10\n#' @inheritParams CoopGameBaseParams\n#' @return \\code{TRUE} if the game is weakly superadditive, else \\code{FALSE}.\n#' @examples\n#' #Example of a weakly superadditive game\n#' library(CoopGame)\n#' A=c(1:15)\n#' isWeaklySuperadditiveGame(A)\n#' \n#' #Example of a game which is not weakly superadditive\n#' library(CoopGame)\n#' A=c(1:5,7,7)\n#' isWeaklySuperadditiveGame(A)\n#' \nisWeaklySuperadditiveGame<-function(A){\n  isWS=GamePropertyWeakSuperadditivity(A)\n  return(determineProperty(isWS))\n}\n\nlogicIsWeaklySuperadditiveGame<-function(A){\n  n=getNumberOfPlayers(A)\n  bm=as.data.frame(createBitMatrix(n=n,A))\n  \n  for(i in (n-1):1){\n    lb=indexLower(n,i);\n    ub=indexUpper(n,i);\n\n    for(j in indexUpper(n,i+1):indexLower(n,i+1)){\n      playersInvolved=((bm[j,1:n])&1)\n      playersUninvolved=!playersInvolved\n      \n \n      #builds expression for identifying rows of data.frame where uninvolved players are contained\n      exp=paste0(\"(\",paste(c(\"0\",colnames(bm)[c(playersUninvolved,FALSE)],\"0\"),collapse = \"|\"),\")\")\n\n      #select all possible coalition values only out of subset S union i\n      #(therefore exclude rows for uninvolved players)\n      v_S=subset(bm[lb:ub,],!(eval(parse(text=exp))==1),\"cVal\")\n      \n      #select all single coalition values of involved players and put them in reverse order\n      v_i=rev(bm[1:n,][playersInvolved,\"cVal\"])\n      \n      #check if condition for currently considered entries is violated\n      v_Splusi=v_S+v_i\n      v_Sui=bm[j,\"cVal\"]\n      if(!all(v_Splusi<=v_Sui,TRUE)){\n<<<<<<< .mine\n       return(FALSE)\n||||||| .r570\n        print(paste(\"Game property 'weakly additive' is violated for instance for coalition S with index\",rownames(v_S)[!v_Splusi<=v_Sui],\"and player i as\",i))\n        return(FALSE)\n=======\n        # print(paste(\"Game property 'weakly additive' is violated for instance for coalition S with index\",rownames(v_S)[!v_Splusi<=v_Sui],\"and player i as\",i))\n        return(FALSE)\n>>>>>>> .r577\n      }\n\n    }\n  }\n  \n  return(TRUE)\n  \n  \n}\n\n#' @title GamePropertyWeakSuperadditivity\n#' @noRd\n#' @include GameProperty.R\n#' #@exportClass GamePropertyWeakSuperadditivity\n\nsetClass(\n  \"GamePropertyWeakSuperadditivity\",\n  contains = \"GameProperty\"\n)\n\n#' @title Constructor for GamePropertyWeakSuperadditivity\n#' @noRd\n#' @template author/JA\n#' @name GamePropertyWeakSuperadditivity\n#' #@export\nGamePropertyWeakSuperadditivity<-function(A){\n  retGamePropertyWeakSuperadditivity=methods::new(\"GamePropertyWeakSuperadditivity\",A)\n  return(retGamePropertyWeakSuperadditivity)\n}\n\n#' @rdname determineProperty-methods\n#' @aliases determineProperty,GamePropertyWeakSuperadditivity-method\nsetMethod(\n  \"determineProperty\",\n  signature=\"GamePropertyWeakSuperadditivity\",\n  definition=function(.Object){\n    A<-.Object@A\n    result=logicIsWeaklySuperadditiveGame(A)\n    return(result)\n  }\n)\n",
    "created" : 1536696040591.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "991330473",
    "id" : "DD806BE8",
    "lastKnownWriteTime" : 1537215659,
    "last_content_update" : 1537215659,
    "path" : "C:/Users/Johannes/Dropbox/UNIVERSITAET/Master_Inf/MASTER_ARBEIT/SVN_REPO/CoopGame/R/GamePropertyWeakSuperadditivity.R",
    "project_path" : "R/GamePropertyWeakSuperadditivity.R",
    "properties" : {
    },
    "relative_order" : 130,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}