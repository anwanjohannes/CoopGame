{
    "collab_server" : "",
    "contents" : "#' @name reasonableSetVertices\n#' @title reasonableSetVertices\n#' @description Calculates the reasonable set for given game vector A.\n#' @aliases reasonableSetVertices\n#' @import rcdd\n#' @importFrom grDevices chull\n#' @export reasonableSetVertices\n#' @template author/JS\n#' @template cites/MILNOR_1953\n#' @template cites/BRANZEI_ET_AL_2006\n#' @templateVar BRANZEI_ET_AL_2006_P p. 21\n#' @template cites/CHAKRAVARTY_ET_AL_2015\n#' @templateVar CHAKRAVARTY_ET_AL_2015_P p. 43 ff.\n#' @inheritParams CoopGameBaseParams\n#' @return rows of the matrix are the vertices of the reasonable set\n#' @examples\n#' library(CoopGame)\n#' A <- c(0,0,0,3,3,3,6)\n#' reasonableSetVertices(A)\n#' #       [,1] [,2] [,3]\n#' # [1,]    3    0    3\n#' # [2,]    0    3    3\n#' # [3,]    3    3    0\nreasonableSetVertices<-function(A){\n  wv=ReasonableSetConcept(A)\n  payoffSpace=calculateSetSolution(wv)\n  return(payoffSpace@VRepMatrix)\n}\n\n\nlogicReasonableSetVertices <- function(A){ \n  numberOfPlayers = getNumberOfPlayers(A)\n    if(isEssentialGame(A) == TRUE){\n      m <- A[1:numberOfPlayers]\n      M <- rep(0,numberOfPlayers)\n      marginalContributions <- getMarginalContributions(A)$marginal_values\n      for (i in 1:numberOfPlayers)\n      {\n        M[i] <- max(marginalContributions[,i])\n      }\n      matrixA1_help1 = diag(rep(-1,numberOfPlayers))\n      matrixA1_help2 = diag(rep(1,numberOfPlayers))\n      matrixA1 <- rbind(matrixA1_help1, matrixA1_help2)\n      matrixA2 = matrix(rep(-1,numberOfPlayers),nrow = 1)\n      vectorB1 <- c(-m,M)\n      vectorB2 = -A[length(A)]\n      \n      # Utilize the R-Package rcdd\n      hRepresentation = makeH(matrixA1,vectorB1,matrixA2,vectorB2)\n      vRepresentation = scdd(hRepresentation)\n      \n      #Transform the V-Representation into a matrix\n      VectorCounter = length(vRepresentation[[1]]) / (numberOfPlayers + 2)\n      OutcomeVector = vRepresentation[[1]][(VectorCounter * 2 + 1):(length(vRepresentation[[1]]))]\n      ResultMatrix = matrix(OutcomeVector, VectorCounter, numberOfPlayers)   \n      \n      if(numberOfPlayers == 3)\n      {\n        sequencevector = grDevices::chull(ResultMatrix)\n        OutcomeMatrix = ResultMatrix[sequencevector,,drop=FALSE]\n      }\n      else\n      {\n        OutcomeMatrix = ResultMatrix\n      }\n    }\n    else\n    {\n      print(\"The reasonable set is empty\")\n      OutcomeMatrix = matrix(ncol = numberOfPlayers,nrow = 0)\n    }\n  return(OutcomeMatrix)\n}\n\n#' @title ReasonableSetConcept - class for reasonable set concept\n#' @noRd\n#' @include SetSolutionConcept.R\n#' #@exportClass ReasonableSetConcept\n\nsetClass(\n  \"ReasonableSetConcept\",\n  contains = \"SetSolutionConcept\"\n)\n\n#' @title Constructor for ReasonableSetConcept\n#' @noRd\n#' @template author/JS\n#' @name ReasonableSetConcept\n#' @include PayoffSpace.R\n#' #@export\nReasonableSetConcept<-function(A){\n  retReasonableSetConcept=methods::new(\"ReasonableSetConcept\",A)\n  return(retReasonableSetConcept)\n}\n\n#' @rdname getSetSolutionVertices-methods\n#' @aliases getSetSolutionVertices,ReasonableSetConcept-method\nsetMethod(\n  \"getSetSolutionVertices\",\n  signature=\"ReasonableSetConcept\",\n  definition=function(.Object){\n    A<-.Object@A\n    VRep=(logicReasonableSetVertices(A))\n    return(VRep)\n  }\n)\n\n\n#' @name belongsToReasonableSet\n#' @title belongsToReasonableSet for every number of players\n#' @description Checks, if the point is in the reasonable set\n#' @aliases belongsToReasonableSet\n#' @import geometry\n#' @import rcdd\n#' @export belongsToReasonableSet\n#' @template author/JS\n#' @template param/x\n#' @inheritParams CoopGameBaseParams\n#' @return \\code{TRUE} if point belongs to reasonable set, \\code{FALSE} otherwise\n#' @examples\n#' library(CoopGame)\n#' A <- c(0,0,0,3,3,3,6)\n#' belongsToReasonableSet(x=c(2,2,2),A)\n#' #[1] TRUE\n#' belongsToReasonableSet(x=c(1,2,4),A)\n#' #[1] FALSE\n\nbelongsToReasonableSet<-function(x,A){\n  ccv=reasonableSetVertices(A) \n  ps=PayoffSpace(VRepMatrix=ccv)\n  return(isElementOfPayoffSpace(ps,x=x))\n}\n\n#' @name drawReasonableSet\n#' @title drawReasonableSet for n players\n#' @description drawReasonableSet draws the Reasonable Set for 3 or 4 players.\n#' @aliases drawReasonableSet\n#' @export drawReasonableSet\n#' @import rgl\n#' @template author/JS\n#' @template cites/CHAKRAVARTY_ET_AL_2015\n#' @templateVar CHAKRAVARTY_ET_AL_2015_P p. 43 ff.\n#' @inheritParams  CoopGameBaseParams\n#' @inheritParams visualize\n#' @examples\n#' library(CoopGame)\n#' A <- c(0,0,0,3,3,3,6)\n#' drawReasonableSet(A)\ndrawReasonableSet<-function(A,holdOn=FALSE, colour = NA , label=FALSE, name = \"Reasonable Set\"){\n  A=GameVector(A)\n  co=reasonableSetVertices(A);\n  visualize(A, pointsToDraw=co, holdOn=holdOn, colour = colour , label=label, name = name)\n}\n",
    "created" : 1536695329122.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2405652074",
    "id" : "15F7AA0C",
    "lastKnownWriteTime" : 1537215659,
    "last_content_update" : 1537215659,
    "path" : "C:/Users/Johannes/Dropbox/UNIVERSITAET/Master_Inf/MASTER_ARBEIT/SVN_REPO/CoopGame/R/ReasonableSetConcept.R",
    "project_path" : "R/ReasonableSetConcept.R",
    "properties" : {
    },
    "relative_order" : 121,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}