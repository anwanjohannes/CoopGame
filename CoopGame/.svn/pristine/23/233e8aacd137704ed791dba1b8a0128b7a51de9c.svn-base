#' @name isEssentialGame
#' @title isEssentialGame
#' @description Checks if a TU game for n players is essential.
#' A game is said to be essential, if the players in the grand coalition generate more \cr 
#' or as much as the sum of the values of the singleton coalitions
#' A game is essential, if \deqn{v(N) >= \sum v({i})}. \cr
#' For an essential game the imputation set is nonempty.
#' @aliases isEssentialGame
#' @export isEssentialGame
#' @template author/MM
#' @template author/JS
#' @template cites/PELEG_ET_SUDHOELTER_2007
#' @templateVar PELEG_ET_SUDHOELTER_2007_P p. 11
#' @inheritParams CoopGameBaseParams
#' @return \code{TRUE} if the game is essential, else \code{FALSE}. 
#' @examples
#'
#' A <- c(0,0,0,60,60,60,72)
#'
#' isEssentialGame(A)
#' #returns [1] TRUE FALSE
#'
#' B <- c(30,30,15,60,60,60,72)
#'
#' isEssentialGame(B)
#' #returns [1] FALSE FALSE
#'
#' C <- c(20,20,32,60,60,60,72)
#'
#' isEssentialGame(C)
#' #returns [1] TRUE TRUE
isEssentialGame<-function(A){
  isE=GamePropertyEssentiality(A)
  return(determineProperty(isE))
}

logicIsEssentialGame <- function(A) {
  #get number of players
  numberOfPlayers <- getNumberOfPlayers(A)

  isEssential <- FALSE


  # sum up values for singleton coalitions and get value generated by the grand coalition
  scVal <- sum(A[1:numberOfPlayers])

  gcVal <- A[length(A)]

  if (gcVal > scVal) {
    isEssential <- TRUE
  } else if (gcVal == scVal) {
    isEssential <- TRUE
  } else {
    isEssential <- FALSE
  }

  return(isEssential)

  # old
  #return(isEssential)
}

#' @title GamePropertyEssentiality
#' @noRd
#' @include GameProperty.R
#' @exportClass GamePropertyEssentiality

setClass(
  "GamePropertyEssentiality",
  contains = "GameProperty"
)

#' @title Constructor for GamePropertyEssentiality
#' @noRd
#' @template author/JA
#' @name GamePropertyEssentiality
#' #@export
GamePropertyEssentiality<-function(A){
  retGamePropertyEssentiality=methods::new("GamePropertyEssentiality",A)
  return(retGamePropertyEssentiality)
}

#' @rdname determineProperty-methods
#' @aliases determineProperty,GamePropertyEssentiality-method
setMethod(
  "determineProperty",
  signature="GamePropertyEssentiality",
  definition=function(.Object){
    A<-.Object@A
    result=logicIsEssentialGame(A)
    return(result)
  }
)



