#' @name getMinimumWinningCoalitions
#' @title getMinimumWinningCoalitions
#' @description The function getMinimumWinningCoalitions identifies all minimal winning coalitions.
#' These coalitions are characterized by the circumstance that without any coalition's casual player the other players
#' generate no value (then also called a losing coalition) - all players can therefore be described as critical players.
#' @aliases getMinimumWinningCoalitions
#' @export getMinimumWinningCoalitions
#' @template author/JA
#' @template cites/PETERS_2015
#' @templateVar PETERS_2015_P p. 295
#' @template param/A
#' @return Is a matrix containing all minimum winning coalitions.
#' @examples
#' A=cFuncQuotaVector(n=3,w=c(1,2,3),q=5)
#' bm=createBitMatrix(3,A)
#' bm
#'# Output:
#'#            cVal
#'# [1,] 1 0 0    0
#'# [2,] 0 1 0    0
#'# [3,] 0 0 1    0
#'# [4,] 1 1 0    0
#'# [5,] 1 0 1    0
#'# [6,] 0 1 1    1
#'# [7,] 1 1 1    1
#'
#'getMinimumWinningCoalitions(A)
#'# Output:
#'#           cVal
#'#[1,] 0 1 1    1
#'# => the coalition containing player 2 and 3 is minimal 


getMinimumWinningCoalitions=function(A){

  paramCheckResult=getEmptyParamCheckResult()
  stopOnInvalidGameVectorA(paramCheckResult,A)
  if(!isSimpleGame(A)){
    print("Game is not simple therefore no minimum winning coalitions can be retrieved.")
    return(NULL)
  }else{
    bitMatrix=createBitMatrix(n=getNumberOfPlayers(A),A)
    criticalMatrix=bitMatrix
    numberOfPlayers=getNumberOfPlayers(A)
    criticalCoalitions=c()
    rowsToBeRemoved=c()
    minimumWinnigCoalitions=c()
    for(player in 1:numberOfPlayers){
      #get all critical coalitions of player 
      criticalCoalitions=getCoalitionsWherePlayerCritical(player,bitMatrix)[,"bmRow"]
      #define all entries as 0 for player column
      criticalMatrix[,player]=0
      
      #set 1 where player is critical
      criticalMatrix[criticalCoalitions,player]=1
    }
    #compare every row of bitMatrix and criticalMatrix
    for(bmIx in 1:nrow(bitMatrix)){
      #if coalition is mwc both rows are identical
      if(identical(bitMatrix[bmIx,],criticalMatrix[bmIx,])){
        minimumWinnigCoalitions=c(minimumWinnigCoalitions,bmIx)
      }
    }
    return(bitMatrix[minimumWinnigCoalitions,,drop=FALSE])
  }
}