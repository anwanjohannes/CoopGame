#' @name publicGoodIndex
#' @title publicGoodIndex
#' @description Calculates the Public Good Index (aka Holler Index) for a specified simple game.
#' @aliases publicGoodIndex, hollerIndex
#' @export publicGoodIndex
#' @template author/JA
#' @template author/JS
#' @template cites/HOLLER_ET_PACKEL_1983
#' @templateVar HOLLER_ET_PACKEL_1983_P pp. 21 -- 29
#' @inheritParams CoopGameBaseParams
#' @return The return value is a vector which contains for each player the calculated public good index
#' @examples
#' 
#' A=c(0,0,0,1,1,0,1)
#' publicGoodIndex(A) #result: 0.50 0.25 0.25 
publicGoodIndex<-function(A){
  pgi=PublicGoodConcept(A)
  return(calculatePowerIndex(pgi))
}

logicPublicGoodIndex=function(A){
  if(!isSimpleGame(A)){
    print("Game is not simple. Therefore no Public Good Index can be retrieved")
  }
  else 
  {
    n=getNumberOfPlayers(A)
    bm=createBitMatrix(n,A)
    mwcs=getMinimumWinningCoalitions(bm)
   
    
    temp=sapply(c(1:n),function(i){sum(mwcs[mwcs[,i]==1,"cVal"])})
    sumPlayerValues=sum(temp)
    pgi=sapply(c(1:n),function(i){temp[i]/sumPlayerValues})
  
    return(PGI=pgi)
  }
}


#' @title PublicGoodConcept - S4 class for Public Good concept
#' @noRd
#' @description PublicGoodConcept
#' @include PointSolutionConcept.R
# @exportClass PublicGoodConcept

setClass(
  "PublicGoodConcept",
  contains = "PointSolutionConcept"
)

#' @rdname calculatePowerIndex-methods
#' @aliases calculatePowerIndex,PublicGoodConcept-method
setMethod(
  "calculatePowerIndex",
  signature="PublicGoodConcept",
  definition=function(.Object){
    A<-.Object@A
    return(logicPublicGoodIndex(A))
  }
)

#' @title Constructor for PublicGoodConcept
#' @noRd
#' @template author/JA
#' @name PublicGoodConcept
#' #@export
PublicGoodConcept<-function(A){
  retPublicGoodIndex=methods::new("PublicGoodConcept",A)
  return(retPublicGoodIndex)
}


#' @name drawPublicGoodValue
#' @title drawPublicGoodValue for 3 or 4 players
#' @description drawPublicGoodValue draws the Public Good Value for 3 or 4 players.
#' @aliases drawPublicGoodValue
#' @export drawPublicGoodValue
#' @template author/JA
#' @template author/JS
#' @template cites/HOLLER_ET_PACKEL_1983
#' @templateVar HOLLER_ET_PACKEL_1983_P pp. 21 -- 29
#' @inheritParams CoopGameBaseParams
#' @inheritParams visualize
#' @examples
#' A=c(0,0,0,1,1,0,1)
#' drawPublicGoodValue(A)
drawPublicGoodValue<-function(A,holdOn=FALSE, colour = NA , label=TRUE, name = "Public Good value"){
  A=GameVector(A)
  pgv=publicGoodValue(A);
  visualize(A, pointsToDraw=pgv, holdOn=holdOn, colour = colour , label=label, name = name)
}
