#' @title PointSolutionConcept - Virtual class for point valued solution concepts
#' @description Virtual class for point valued solution concepts
#' @name PointSolutionConcept
#' @include CoopGameSolution.R
#' @exportClass PointSolutionConcept

setClass(
  "PointSolutionConcept",
  representation("VIRTUAL"),
  contains = "CoopGameSolution"
)



#' @title calculatePointSolution
#' @name calculatePointSolution
#' @description calculatePointSolution
#' @template author/JA
#' @exportMethod calculatePointSolution
setGeneric(
  "calculatePointSolution",
  function(.Object){
    standardGeneric("calculatePointSolution")
  }
)


setMethod(
  "calculatePointSolution",
  signature="PointSolutionConcept",
  definition=function(.Object){
    A<-.Object@A
    N<-length(A)
    powerIndex<-calculatePowerIndex(.Object)
    return((powerIndex*A[N])/sum(powerIndex))
  }
)


setMethod(
  "calculateSolution",
  signature="PointSolutionConcept",
  definition=function(.Object){
    calculatePointSolution(.Object)
  }
)

#' @title calculatePowerIndex
#' @description calculates power index
#' @name calculatePowerIndex
#' @template author/JA
#' @exportMethod calculatePowerIndex
setGeneric(
  "calculatePowerIndex",
  function(.Object){
    standardGeneric("calculatePowerIndex")
  }
)


setMethod(
  "calculatePowerIndex",
  signature="PointSolutionConcept",
  definition=function(.Object){
    pointSolution=calculatePointSolution(.Object)
    sum=sum(pointSolution)
    return(pointSolution/sum)
  }
)
